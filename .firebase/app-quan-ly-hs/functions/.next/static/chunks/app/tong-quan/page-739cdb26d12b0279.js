(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7430],{93727:function(e,t,n){Promise.resolve().then(n.bind(n,96627))},96627:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var r=n(27573),a=n(88146),i=n(72196),c=n(2389);let s=(0,c.Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var l=n(83989),o=n(18948);let u=(0,c.Z)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),h=(0,c.Z)("BookCheck",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"m9 9.5 2 2 4-4",key:"1dth82"}]]),d=(0,c.Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);var p=n(86548),m=n(75330),f=n(76553);let g=[{title:"Ghi nhận Vi phạm & Th\xe0nh t\xedch",description:"Nhập điểm thi đua, điểm cộng, điểm trừ cho học sinh v\xe0 tập thể lớp.",href:"/ghi-nhan",icon:(0,r.jsx)(s,{className:"h-8 w-8 text-amber-600"}),access:["isSuperAdmin","isProctor"],color:"text-amber-600"},{title:"Quản l\xfd Học sinh",description:"Tra cứu, chỉnh sửa th\xf4ng tin v\xe0 xem lịch sử thi đua của học sinh.",href:"/hoc-sinh",icon:(0,r.jsx)(l.Z,{className:"h-8 w-8 text-sky-600"}),access:["isSuperAdmin","isViewerAdmin","isHomeroomTeacher"],color:"text-sky-600"},{title:"Bảng Xếp Hạng Tuần",description:"Theo d\xf5i thứ hạng v\xe0 điểm số thi đua của tất cả c\xe1c lớp trong tuần.",href:"/bang-xep-hang",icon:(0,r.jsx)(o.Z,{className:"h-8 w-8 text-emerald-600"}),access:"any",color:"text-emerald-600"},{title:"Thống k\xea & B\xe1o c\xe1o",description:"Ph\xe2n t\xedch, xuất b\xe1o c\xe1o tổng hợp về t\xecnh h\xecnh thi đua to\xe0n trường.",href:"/reports",icon:(0,r.jsx)(u,{className:"h-8 w-8 text-rose-600"}),access:["isSuperAdmin","isViewerAdmin"],color:"text-rose-600"},{title:"Quy Định Chấm Điểm",description:"Tra cứu danh mục c\xe1c h\xe0nh vi, nội quy v\xe0 mức điểm quy định.",href:"/rules",icon:(0,r.jsx)(h,{className:"h-8 w-8 text-indigo-600"}),access:"any",color:"text-indigo-600"},{title:"Quản l\xfd Lớp & Khối",description:"Cấu h\xecnh danh s\xe1ch lớp học, khối v\xe0 c\xe1c th\xf4ng tin li\xean quan.",href:"/class-management",icon:(0,r.jsx)(d,{className:"h-8 w-8 text-cyan-600"}),access:["isSuperAdmin"],color:"text-cyan-600"},{title:"Quản l\xfd Người d\xf9ng",description:"Th\xeam, sửa v\xe0 ph\xe2n quyền cho c\xe1c t\xe0i khoản người d\xf9ng trong hệ thống.",href:"/nguoi-dung",icon:(0,r.jsx)(p.Z,{className:"h-8 w-8 text-red-700"}),access:["isSuperAdmin"],color:"text-red-700"},{title:"Hồ Sơ C\xe1 Nh\xe2n",description:"Xem lại th\xf4ng tin c\xe1 nh\xe2n v\xe0 c\xe1c hoạt động đ\xe3 thực hiện.",href:"/ho-so",icon:(0,r.jsx)(m.Z,{className:"h-8 w-8 text-slate-600"}),access:"any",color:"text-slate-600"}];function x(){var e;let t=(0,f.a)();if(t.loading)return(0,r.jsx)("div",{className:"space-y-6 p-4 md:p-8",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Tổng Quan"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Đang tải dữ liệu người d\xf9ng..."})]})});let n=t.user?g.filter(e=>"any"===e.access||!!Array.isArray(e.access)&&e.access.some(e=>t[e])):[];return(0,r.jsxs)("div",{className:"space-y-6 p-4 md:p-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Tổng Quan"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Chọn một chức năng để bắt đầu l\xe0m việc."})]}),!(null===(e=t.userProfile)||void 0===e?void 0:e.role)&&(0,r.jsxs)("div",{className:"p-4 mb-4 text-sm text-yellow-800 rounded-lg bg-yellow-50 dark:bg-gray-800 dark:text-yellow-300",role:"alert",children:[(0,r.jsx)("span",{className:"font-medium",children:"Ch\xfa \xfd!"})," T\xe0i khoản của bạn hiện chưa được ph\xe2n quyền. Vui l\xf2ng li\xean hệ quản trị vi\xean để được cấp quyền truy cập c\xe1c chức năng quản l\xfd."]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(e=>(0,r.jsx)(a.default,{href:e.href,children:(0,r.jsx)(i.Zb,{className:"hover:shadow-lg transition-all duration-200 h-full group border-l-4",style:{borderColor:e.color},children:(0,r.jsxs)(i.Ol,{className:"flex flex-row items-center gap-4",children:[e.icon,(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)(i.ll,{className:"group-hover:underline text-lg ".concat(e.color),children:e.title}),(0,r.jsx)(i.SZ,{className:"mt-1 text-sm",children:e.description})]})]})})},e.href))})]})}},72196:function(e,t,n){"use strict";n.d(t,{Ol:function(){return s},SZ:function(){return o},Zb:function(){return c},aY:function(){return u},ll:function(){return l}});var r=n(27573),a=n(7653),i=n(29147);let c=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",n),...a})});c.displayName="Card";let s=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",n),...a})});s.displayName="CardHeader";let l=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("h3",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",n),...a})});l.displayName="CardTitle";let o=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",n),...a})});o.displayName="CardDescription";let u=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",n),...a})});u.displayName="CardContent",a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",n),...a})}).displayName="CardFooter"},76553:function(e,t,n){"use strict";n.d(t,{H:function(){return g},a:function(){return x}});var r=n(27573),a=n(7653),i=n(78022),c=n(66356),s=n(81695);let l=(0,a.createContext)(void 0),o=["/login","/auth/action"],u={admin:"/tong-quan",viewerAdmin:"/tong-quan",teacher:"/lop-cua-toi",default:"/tong-quan"},h=e=>"admin"===e,d=e=>["hieu_truong","pho_hieu_truong","nv_tin_hoc"].includes(e||""),p=e=>["giao_vien_chu_nhiem","homeroom_teacher"].includes(e||""),m=e=>"giam_thi"===e;function f(){let e=(0,i.v0)(c.l),[t,n]=(0,a.useState)(""),s=async()=>{if(e.currentUser)try{await (0,i.w$)(e.currentUser),n("Đ\xe3 gửi lại email x\xe1c thực. Vui l\xf2ng kiểm tra hộp thư của bạn.")}catch(e){console.error(e),n("Lỗi: ".concat(e.message))}},l=async()=>{try{await e.signOut()}catch(e){console.error("Error signing out:",e)}};return(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",textAlign:"center",padding:"20px",backgroundColor:"#f0f2f5"},children:[(0,r.jsx)("h1",{style:{fontSize:"24px",marginBottom:"20px"},children:"Y\xeau cầu X\xe1c thực Email"}),(0,r.jsx)("p",{style:{marginBottom:"20px"},children:"T\xe0i khoản của bạn chưa được x\xe1c thực. Vui l\xf2ng kiểm tra hộp thư v\xe0 nhấn v\xe0o li\xean kết x\xe1c thực để tiếp tục."}),(0,r.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,r.jsx)("button",{onClick:s,style:{padding:"10px 20px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Gửi lại Email"}),(0,r.jsx)("button",{onClick:l,style:{padding:"10px 20px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Đăng xuất"})]}),t&&(0,r.jsx)("p",{style:{marginTop:"20px",color:"green"},children:t})]})}function g(e){let{children:t}=e,[n,g]=(0,a.useState)(null),[x,_]=(0,a.useState)(null),[E,y]=(0,a.useState)(!0),[v,N]=(0,a.useState)(!1),k=(0,s.useRouter)(),C=(0,s.usePathname)();(0,a.useEffect)(()=>{let e=(0,i.v0)(c.l),t=(0,i.Aj)(e,async t=>{if(t)try{await t.reload();let a=e.currentUser;if(a&&(g(a),N(a.emailVerified),a.emailVerified)){var n,r;let e=(await a.getIdTokenResult()).claims,t=e.assignedClasses,i=[];Array.isArray(t)?i=t:"string"==typeof t&&t.length>0&&(i=t.split(",").map(e=>e.trim()));let c={displayName:null!==(n=a.displayName)&&void 0!==n?n:void 0,email:null!==(r=a.email)&&void 0!==r?r:void 0,role:e.role,assignedClasses:i};_(c),c.role||console.warn("User logged in but has no 'role' claim. UID: ".concat(a.uid))}}catch(e){console.error("Error processing auth state:",e),_(null),g(null)}else _(null),g(null),N(!1);y(!1)});return()=>t()},[]);let I=null==x?void 0:x.role,A=h(I),T=d(I),w=p(I),S=m(I),b=A||T;return((0,a.useEffect)(()=>{if(E)return;let e=o.includes(C);n&&v?(e||"/"===C)&&(A?k.push(u.admin):T?k.push(u.viewerAdmin):w?k.push(u.teacher):k.push(u.default)):n||e||k.push("/login")},[n,v,E,C,k,A,T,w]),E)?(0,r.jsx)("div",{children:"Đang tải..."}):n&&!v?o.includes(C)?(0,r.jsx)(r.Fragment,{children:t}):(0,r.jsx)(f,{}):(0,r.jsx)(l.Provider,{value:{user:n,userProfile:x,isAdmin:b,isSuperAdmin:A,isViewerAdmin:T,isHomeroomTeacher:w,isProctor:S,loading:E},children:t})}function x(){let e=(0,a.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},66356:function(e,t,n){"use strict";n.d(t,{l:function(){return h},I:function(){return p},db:function(){return d}});var r=n(90791),a=n(21897),i=n(78022),c=n(17865),s=n(68571);function l(e){let t=s.env[e];if(!t||""===t.trim())throw Error("Thiếu biến m\xf4i trường ".concat(e,". Kiểm tra .env.local / secrets."));return t}let o={NEXT_PUBLIC_FIREBASE_API_KEY:l("NEXT_PUBLIC_FIREBASE_API_KEY"),NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN:l("NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN"),NEXT_PUBLIC_FIREBASE_PROJECT_ID:l("NEXT_PUBLIC_FIREBASE_PROJECT_ID"),NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET:l("NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET"),NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID:l("NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID"),NEXT_PUBLIC_FIREBASE_APP_ID:l("NEXT_PUBLIC_FIREBASE_APP_ID"),NEXT_PUBLIC_RECAPTCHA_SITE_KEY:l("NEXT_PUBLIC_RECAPTCHA_SITE_KEY")},u={apiKey:o.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:o.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:o.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:o.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:o.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:o.NEXT_PUBLIC_FIREBASE_APP_ID},h=(0,r.C6)().length?(0,r.Mq)():(0,r.ZF)(u);{let e=globalThis;e.__firebaseAppCheckInitialized||(e.__firebaseAppCheckInitialized=!0,(0,c.yu)(h,{provider:new c.o4(o.NEXT_PUBLIC_RECAPTCHA_SITE_KEY),isTokenAutoRefreshEnabled:!0}))}let d=(0,a.ad)(h),p=(0,i.v0)(h)},29147:function(e,t,n){"use strict";n.d(t,{Es:function(){return l},Hg:function(){return u},ap:function(){return o},cn:function(){return i}});var r=n(10607),a=n(25579);function i(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.m6)((0,r.W)(t))}let c=new Date(2025,8,8),s=e=>{let t=new Date(e);return t.setHours(0,0,0,0),t},l=()=>{let e=[{value:"",label:"Tất cả c\xe1c tuần"}],t=e=>e<10?"0".concat(e):"".concat(e);for(let n=1;n<=35;n++){let r=new Date(s(c).getTime()+(n-1)*6048e5),a=new Date(r.getTime()+5184e5);e.push({value:String(n),label:"Tuần ".concat(n," (").concat(t(r.getDate()),"/").concat(t(r.getMonth()+1)," - ").concat(t(a.getDate()),"/").concat(t(a.getMonth()+1),")")})}return e},o=e=>{if(!e)return"";let t=e.match(/(?:class_)?(\d+)/);return t?t[1]:""},u=e=>e&&e.startsWith("class_")?e.substring(6).replace(/_/g,"/"):e},2389:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(7653);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>!!e&&n.indexOf(e)===t).join(" ")};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=(0,r.forwardRef)((e,t)=>{let{color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:l,className:o="",children:u,iconNode:h,...d}=e;return(0,r.createElement)("svg",{ref:t,...c,width:a,height:a,stroke:n,strokeWidth:l?24*Number(s)/Number(a):s,className:i("lucide",o),...d},[...h.map(e=>{let[t,n]=e;return(0,r.createElement)(t,n)}),...Array.isArray(u)?u:[u]])}),l=(e,t)=>{let n=(0,r.forwardRef)((n,c)=>{let{className:l,...o}=n;return(0,r.createElement)(s,{ref:c,iconNode:t,className:i("lucide-".concat(a(e)),l),...o})});return n.displayName="".concat(e),n}},86548:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(2389).Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},18948:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(2389).Z)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]])},75330:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(2389).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},83989:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(2389).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},81695:function(e,t,n){"use strict";var r=n(21219);n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}}),n.o(r,"useSearchParams")&&n.d(t,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[6415,5117,2997,1661,8146,1293,1528,1744],function(){return e(e.s=93727)}),_N_E=e.O()}]);