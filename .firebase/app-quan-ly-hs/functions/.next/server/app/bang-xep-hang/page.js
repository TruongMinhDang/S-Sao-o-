(()=>{var e={};e.id=283,e.ids=[283],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},57757:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d}),r(33400),r(67310),r(77718),r(87824);var s=r(93282),a=r(5736),n=r(93906),l=r.n(n),i=r(36880),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(t,o);let d=["",{children:["bang-xep-hang",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,33400)),"/home/user/studio/apps/web/src/app/bang-xep-hang/page.tsx"]}]},{error:[()=>Promise.resolve().then(r.bind(r,67310)),"/home/user/studio/apps/web/src/app/bang-xep-hang/error.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,77718)),"/home/user/studio/apps/web/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,87824,23)),"next/dist/client/components/not-found-error"]}],c=["/home/user/studio/apps/web/src/app/bang-xep-hang/page.tsx"],u="/bang-xep-hang/page",m={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/bang-xep-hang/page",pathname:"/bang-xep-hang",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},12359:(e,t,r)=>{Promise.resolve().then(r.bind(r,2532))},90735:(e,t,r)=>{Promise.resolve().then(r.bind(r,98726))},2532:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var s=r(73227);function a({error:e,reset:t}){return(0,s.jsxs)("div",{className:"p-6 text-center",children:[s.jsx("h2",{className:"text-xl font-bold text-red-600",children:"C\xf3 lỗi xảy ra ở trang bảng xếp hạng"}),s.jsx("p",{className:"mt-2 text-gray-700",children:e.message}),s.jsx("button",{className:"mt-4 px-4 py-2 rounded bg-blue-600 text-white",onClick:()=>t(),children:"Thử lại"})]})}},98726:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var s=r(73227),a=r(23677),n=r(63062),l=r(11250),i=r(87030),o=r(21449);r(18755);let d=(0,i.ad)(o.l2),c=new Date(new Date().getFullYear(),8,8),u=e=>{let t=new Date(e);return t.setHours(0,0,0,0),t},m=()=>{let e=[];for(let t=1;t<=35;t++){let r=new Date(u(c).getTime()+(t-1)*6048e5),s=new Date(r.getTime()+5184e5),a=e=>e<10?`0${e}`:`${e}`;e.push(`Tuần ${t} (${a(r.getDate())}/${a(r.getMonth()+1)} - ${a(s.getDate())}/${a(s.getMonth()+1)})`)}return e},p=e=>`class_${e.replace("/","_")}`,x=[{name:"Khối 6",classes:["6/1","6/2","6/3","6/4","6/5","6/6","6/7","6/8","6/9","6/10"]},{name:"Khối 7",classes:["7/1","7/2","7/3","7/4","7/5","7/6","7/7","7/8"]},{name:"Khối 8",classes:["8/1","8/2","8/3","8/4","8/5","8/6","8/7"]},{name:"Khối 9",classes:["9/1","9/2","9/3","9/4","9/5","9/6","9/7","9/8"]}],h=[{key:"hoc_tap",label:"HỌC TẬP",editable:!0},{key:"ky_luat",label:"KỶ LUẬT",editable:!0},{key:"ve_sinh",label:"VỆ SINH",editable:!0},{key:"diem_cong",label:"ĐIỂM CỘNG",editable:!1},{key:"diem_tru",label:"ĐIỂM TRỪ",editable:!1},{key:"tong_diem",label:"TỔNG ĐIỂM",editable:!1},{key:"hang",label:"HẠNG",editable:!1},{key:"nhan_xet",label:"NHẬN X\xc9T",editable:!0}],b=m(),g=(()=>{let e=Math.max(1,Math.min(35,Math.floor(Math.floor((u(new Date).getTime()-u(c).getTime())/864e5)/7)+1));return m().find(t=>t.startsWith(`Tuần ${e} `))||m()[0]})();function f({isOpen:e,onClose:t,onSave:r,classData:n}){let[i,o]=(0,a.useState)({});if(!e||!n)return null;let d=e=>{let{name:t,value:r}=e.target,s=["hoc_tap","ky_luat","ve_sinh"].includes(t);o(e=>({...e,[t]:s?""===r?void 0:Number(r):r}))};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[(0,s.jsxs)("h3",{className:"text-xl font-bold mb-4",children:["Cập nhật điểm cho lớp ",n.className]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Học tập"}),s.jsx("input",{type:"number",name:"hoc_tap",value:i.hoc_tap??"",onChange:d,className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Kỷ luật"}),s.jsx("input",{type:"number",name:"ky_luat",value:i.ky_luat??"",onChange:d,className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Vệ sinh"}),s.jsx("input",{type:"number",name:"ve_sinh",value:i.ve_sinh??"",onChange:d,className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nhận x\xe9t"}),s.jsx("input",{type:"text",name:"nhan_xet",value:i.nhan_xet??"",onChange:d,className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]})]}),(0,s.jsxs)("div",{className:"mt-6 flex justify-end space-x-4",children:[s.jsx(l.z,{variant:"outline",onClick:t,children:"Hủy"}),s.jsx(l.z,{onClick:()=>{r({hoc_tap:i.hoc_tap??0,ky_luat:i.ky_luat??0,ve_sinh:i.ve_sinh??0,nhan_xet:i.nhan_xet}),t()},children:"Lưu thay đổi"})]})]})})}function y(){let[e,t]=(0,a.useState)(g),[r,o]=(0,a.useState)({}),[c,u]=(0,a.useState)({}),[m,y]=(0,a.useState)(!1),[w,j]=(0,a.useState)(null),[N,_]=(0,a.useState)(null),v=(0,a.useMemo)(()=>{let e={};return x.forEach(t=>{let s="Khối 9"===t.name?330:340,a=[];t.classes.forEach(e=>{let n=r[t.name]?.[e]||{},l=c[t.name]?.[e]||{diem_cong:0,diem_tru:0},i=n.hoc_tap??s,o=n.ky_luat??s,d=n.ve_sinh??s,u=i+o+d+l.diem_cong-l.diem_tru;a.push({className:e,hoc_tap:i,ky_luat:o,ve_sinh:d,nhan_xet:n.nhan_xet,...l,tong_diem:u})}),a.sort((e,t)=>t.tong_diem-e.tong_diem),e[t.name]={};let n=0,l=1/0;a.forEach((r,s)=>{r.tong_diem<l&&(n=s+1),e[t.name][r.className]={...r,hang:n},l=r.tong_diem})}),e},[r,c]),k=(e,t)=>{let r=v[e]?.[t]||{};j({gradeName:e,className:t,scores:r}),y(!0)},q=async t=>{if(!w)return;let{gradeName:r,className:s}=w,a=e.match(/\d+/)?.[0];if(!a){alert("Tuần kh\xf4ng hợp lệ.");return}let n=p(s),l=`week_${a}_${n}`,o=(0,i.JU)(d,"weeklyScores",l),c={week:Number(a),classId:n,className:s,gradeName:r,scores:t};try{await (0,i.pl)(o,c,{merge:!0}),y(!1)}catch(e){console.error("Error writing document: ",e),alert("Đ\xe3 c\xf3 lỗi xảy ra khi lưu điểm.")}},$={"Khối 6":{text:"text-red-700",border:"border-red-300",bg:"bg-red-50"},"Khối 7":{text:"text-yellow-700",border:"border-yellow-400",bg:"bg-yellow-50"},"Khối 8":{text:"text-blue-700",border:"border-blue-300",bg:"bg-blue-50"},"Khối 9":{text:"text-green-700",border:"border-green-300",bg:"bg-green-50"}};return(0,s.jsxs)("div",{className:"container mx-auto p-4 md:p-8 bg-gray-50 min-h-screen",children:[s.jsx(f,{isOpen:m,onClose:()=>y(!1),onSave:q,classData:w}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6",children:[s.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800 mb-4 sm:mb-0",children:"Bảng Xếp Hạng Thi Đua"}),(0,s.jsxs)(n.Ph,{onValueChange:t,value:e,children:[s.jsx(n.i4,{className:"w-full sm:w-[320px] bg-white shadow-sm border-gray-300",children:s.jsx(n.ki,{placeholder:"Chọn tuần"})}),s.jsx(n.Bw,{className:"max-h-96 bg-white",children:b.map(e=>s.jsx(n.Ql,{value:e,children:e},e))})]})]}),N&&s.jsx("div",{className:"text-center py-4 bg-red-50 text-red-700 rounded-lg border border-red-200",children:N}),!N&&s.jsx("div",{className:"flex flex-col gap-12",children:x.map(e=>{let t=$[e.name]||$["Khối 9"];return(0,s.jsxs)("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-lg border border-gray-200 transition-all duration-300 hover:shadow-2xl hover:-translate-y-2",children:[(0,s.jsxs)("h2",{className:`text-xl sm:text-2xl font-bold text-center ${t.text} mb-6`,children:["SƠ KẾT H\xc0NG TUẦN - ",e.name.toUpperCase()]}),s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("div",{className:`grid border-l border-t ${t.border}`,style:{gridTemplateColumns:`minmax(120px, 1.5fr) repeat(${e.classes.length}, minmax(90px, 1fr))`},children:[s.jsx("div",{className:`font-bold text-gray-700 p-3 border-r border-b ${t.border} ${t.bg} flex items-center justify-start`,children:"NỘI DUNG"}),e.classes.map(r=>(0,s.jsxs)("div",{className:`font-bold text-gray-800 p-3 border-r border-b ${t.border} ${t.bg} flex items-center justify-center relative group`,children:[r,s.jsx(l.z,{variant:"ghost",size:"sm",className:"ml-1 h-6 w-6 p-0 absolute right-1 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>k(e.name,r),children:"✏️"})]},r)),h.map(r=>(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:`font-semibold p-3 border-r border-b ${t.border} flex items-center ${"hang"===r.key?"bg-yellow-100 text-yellow-900":"bg-white"}`,children:r.label},r.key),e.classes.map(a=>{let n=v[e.name]?.[a],l=n?.[r.key]??("nhan_xet"===r.key?"":0),i=l,o=`p-3 text-center border-r border-b ${t.border} flex items-center justify-center font-medium`;return"hang"===r.key&&(o+=" bg-yellow-200 font-bold text-yellow-900"),"diem_cong"===r.key&&l>0&&(i=`+${l}`,o+=" text-green-600 font-bold"),"diem_tru"===r.key&&l>0&&(i=`-${l}`,o+=" text-red-600 font-bold"),"tong_diem"===r.key&&(o+=" font-bold text-blue-800"),r.editable&&(o+=" cursor-pointer hover:bg-gray-100 transition-colors"),s.jsx("div",{className:o,onClick:()=>r.editable&&k(e.name,a),children:i},a)})]}))]})})]},e.name)})})]})}},63062:(e,t,r)=>{"use strict";r.d(t,{Bw:()=>h,Ph:()=>c,Ql:()=>b,i4:()=>m,ki:()=>u});var s=r(73227),a=r(23677),n=r(98682),l=r(65327),i=r(87090),o=r(56942),d=r(18755);let c=n.fC;n.ZA;let u=n.B4,m=a.forwardRef(({className:e,children:t,...r},a)=>(0,s.jsxs)(n.xz,{ref:a,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,s.jsx(n.JO,{asChild:!0,children:s.jsx(l.Z,{className:"h-4 w-4 opacity-50"})})]}));m.displayName=n.xz.displayName;let p=a.forwardRef(({className:e,...t},r)=>s.jsx(n.u_,{ref:r,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:s.jsx(i.Z,{className:"h-4 w-4"})}));p.displayName=n.u_.displayName;let x=a.forwardRef(({className:e,...t},r)=>s.jsx(n.$G,{ref:r,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:s.jsx(l.Z,{className:"h-4 w-4"})}));x.displayName=n.$G.displayName;let h=a.forwardRef(({className:e,children:t,position:r="popper",...a},l)=>s.jsx(n.h_,{children:(0,s.jsxs)(n.VY,{ref:l,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...a,children:[s.jsx(p,{}),s.jsx(n.l_,{className:(0,d.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),s.jsx(x,{})]})}));h.displayName=n.VY.displayName,a.forwardRef(({className:e,...t},r)=>s.jsx(n.__,{ref:r,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t})).displayName=n.__.displayName;let b=a.forwardRef(({className:e,children:t,...r},a)=>(0,s.jsxs)(n.ck,{ref:a,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm text-foreground outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(n.wU,{children:s.jsx(o.Z,{className:"h-4 w-4"})})}),s.jsx(n.eT,{children:t})]}));b.displayName=n.ck.displayName,a.forwardRef(({className:e,...t},r)=>s.jsx(n.Z0,{ref:r,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",e),...t})).displayName=n.Z0.displayName},21449:(e,t,r)=>{"use strict";r.d(t,{db:()=>d,l2:()=>o});var s=r(27992),a=r(17761),n=r(87030),l=r(53377),i=r(57237);r(42353);let o=(0,s.C6)().length?(0,s.Mq)():(0,s.ZF)({apiKey:"AIzaSyAqGxdFqDGXOiiKP5cKFvPkNkmTdY4aByw",authDomain:"saodoapp--app-quan-ly-hs.asia-southeast1.hosted.app",projectId:"app-quan-ly-hs",storageBucket:"app-quan-ly-hs.firebasestorage.app",messagingSenderId:"771200825229",appId:"1:771200825229:web:bdffe0944b21edff21afc4"});(0,a.v0)(o);let d=(0,n.ad)(o);(0,l.cF)(o),(0,i.$C)(o)},67310:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(53189).createProxy)(String.raw`/home/user/studio/apps/web/src/app/bang-xep-hang/error.tsx#default`)},33400:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(53189).createProxy)(String.raw`/home/user/studio/apps/web/src/app/bang-xep-hang/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[142,202,154,184],()=>r(57757));module.exports=s})();