runtime: nodejs20
build:
  - npm install
  - npm run build --prefix apps/web
  # Dòng này giữ lại để debug nếu cần
  - ls -R .next || echo "Check path"

# Entrypoint giữ nguyên (đã đúng)
entrypoint: node .next/standalone/apps/web/server.js

env:
  # --- ĐÂY LÀ THUỐC ĐẶC TRỊ CHO LỖI TRONG ẢNH ---
  # Bắt buộc phải có 2 dòng này Google mới nhận diện được App
  - variable: HOSTNAME
    value: "0.0.0.0"
  - variable: PORT
    value: "8080"
  # ----------------------------------------------

  - variable: APP_SOSAODO_ID
    secret: firebase-project-id
  - variable: APP_SOSAODO_EMAIL
    secret: FIREBASE_CLIENT_EMAIL
  - variable: APP_SOSAODO_KEY
    secret: FIREBASE_PRIVATE_KEY

runConfig:
  cpu: 1
  memoryMiB: 1024
