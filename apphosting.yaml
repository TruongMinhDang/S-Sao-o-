runtime: nodejs20
build:
  - npm install
  - npm run build --prefix apps/web
  # Lệnh debug: In ra cấu trúc thư mục để xem file server nằm đâu
  - ls -R .next || echo "⚠️ Không thấy thư mục .next"

# --- PHẦN SỬA ĐỔI QUAN TRỌNG ---
# Dùng lệnh này để chạy chính xác file server trong thư mục apps/web
entrypoint: node .next/standalone/apps/web/server.js

env:
  - variable: HOSTNAME
    value: "0.0.0.0"
  - variable: PORT
    value: "8080"

  - variable: APP_SOSAODO_ID
    secret: firebase-project-id
  - variable: APP_SOSAODO_EMAIL
    secret: FIREBASE_CLIENT_EMAIL
  - variable: APP_SOSAODO_KEY
    secret: FIREBASE_PRIVATE_KEY

runConfig:
  cpu: 1
  memoryMiB: 1024
